myApp.directive("dirEnter",function(){return function(a,b,c){return b.bind("keydown keypress",function(b){return 13===b.which?(a.$apply(function(){return a.$eval(c.dirEnter)}),b.preventDefault()):void 0})}}),myApp.directive("dirFieldDate",["directiveService","$filter","generateId",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldDate/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b),b.id=c.generate(),b.idHtag="#"+b.id},post:function(c){a.autoScopeImpl(c),c.result=null,c.$watch("result",function(){return"day"==c.getInfo().minimalDelay?c.resultFormated=b("date")(c.result,"yyyy-MM-dd"):c.resultFormated=b("date")(c.result,"yyyy-MM-dd HH:mm")}),c.isActive=function(){return!(null!=c.getInfo().active&&void 0!=c.getInfo().active&&0==c.getInfo().active())},c.$watch("getInfo().field[getInfo().fieldName]",function(){return null!=c.getInfo().field[c.getInfo().fieldName]?c.result=new Date(Number(c.getInfo().field[c.getInfo().fieldName])):void c.isValid()}),c.$watch("result",function(){return null!=c.result?c.getInfo().field[c.getInfo().fieldName]=c.result.getTime():c.getInfo().field[c.getInfo().fieldName]=null,c.isValid()}),c.isValid=function(){var a;return c.getInfo().disabled===!0||c.isActive()===!1?void(c.getInfo().isValid=!0):(a=!0,null==c.getInfo().field[c.getInfo().fieldName]&&(a=!1),null!=c.getInfo().validationFct&&(a=a&&c.getInfo().validationFct()),void(c.getInfo().isValid=a))},c.isValid(),c.logField=function(){return console.log(c.getInfo())},c.displayError=function(){return 0==c.getInfo().isValid&&c.getInfo().firstAttempt===!1?!0:!1}}}}}}]),myApp.directive("dirFieldSelect",["directiveService","$timeout","modalService",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldSelect/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(d){a.autoScopeImpl(d),void 0==d.getInfo().autoCompleteValue&&(d.getInfo().autoCompleteValue=[]),d.isActive=function(){return!(null!=d.getInfo().active&&void 0!=d.getInfo().active&&0==d.getInfo().active())},d.errorMessage="",d.isValidationDefined=null!=d.getInfo().validationRegex||null!=d.getInfo().validationFct,d.hideIsValidIcon=!!d.getInfo().hideIsValidIcon,d.fieldType=null!=d.getInfo().fieldType?d.getInfo().fieldType:"text",null==d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]=""),null==d.getInfo().isValid&&(d.getInfo().isValid=!d.isValidationDefined),d.isValidationDefined&&d.$watch("getInfo().field[getInfo().fieldName]",function(a,b){return a!==b?d.isValid():void 0}),d.isValid=function(){var a;return d.getInfo().disabled===!0||d.isActive()===!1?void(d.getInfo().isValid=!0):(d.getInfo().field[d.getInfo().fieldName]||(d.getInfo().field[d.getInfo().fieldName]=""),a=!0,"string"!=typeof d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]+=""),null!=d.getInfo().validationRegex&&(a=null!=d.getInfo().field[d.getInfo().fieldName].match(d.getInfo().validationRegex)),null!=d.getInfo().validationFct&&(a=a&&d.getInfo().validationFct()),void(d.getInfo().isValid=a))},d.isValid(),d.logField=function(){return console.log(d.getInfo())},d.setErrorMessage=function(a){return d.errorMessage=a,null!=d.lastTimeOut&&b.cancel(d.lastTimeOut),d.lastTimeOut=b(function(){return d.errorMessage="",d.lastTimeOut=null},2e3)},d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.openCalculator=function(){c.openCalculatorModal(new function(a){d.getInfo().field[d.getInfo().fieldName]=a})}}}}}}]),myApp.directive("dirFieldText",["directiveService","$timeout","modalService",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldText/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(d){a.autoScopeImpl(d),void 0==d.getInfo().autoCompleteValue&&(d.getInfo().autoCompleteValue=[]),d.isActive=function(){return!(null!=d.getInfo().active&&void 0!=d.getInfo().active&&0==d.getInfo().active())},d.errorMessage="",d.isValidationDefined=null!=d.getInfo().validationRegex||null!=d.getInfo().validationFct,d.hideIsValidIcon=!!d.getInfo().hideIsValidIcon,d.fieldType=null!=d.getInfo().fieldType?d.getInfo().fieldType:"text",null==d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]=""),null==d.getInfo().isValid&&(d.getInfo().isValid=!d.isValidationDefined),d.isValidationDefined&&d.$watch("getInfo().field[getInfo().fieldName]",function(a,b){return d.isValid()}),d.$watch("getInfo().active()",function(a,b){a!=b&&d.isValid()},!0),d.isValid=function(){var a;return d.getInfo().disabled===!0||d.isActive()===!1?void(d.getInfo().isValid=!0):(null==d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]=""),a=!0,"string"!=typeof d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]+=""),null!=d.getInfo().validationRegex&&(a=null!=d.getInfo().field[d.getInfo().fieldName].match(d.getInfo().validationRegex)),null!=d.getInfo().validationFct&&(a=a&&d.getInfo().validationFct()),void(d.getInfo().isValid=a))},d.isValid(),d.logField=function(){return console.log(d.getInfo())},d.setErrorMessage=function(a){return d.errorMessage=a,null!=d.lastTimeOut&&b.cancel(d.lastTimeOut),d.lastTimeOut=b(function(){return d.errorMessage="",d.lastTimeOut=null},2e3)},d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.openCalculator=function(){c.openCalculatorModal(new function(a){d.getInfo().field[d.getInfo().fieldName]=a})}}}}}}]),myApp.directive("dirFieldTextArea",["directiveService","$timeout","modalService","$timeout",function(a,b,c,b){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldTextArea/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(d){a.autoScopeImpl(d),void 0==d.getInfo().autoCompleteValue&&(d.getInfo().autoCompleteValue=[]),d.isActive=function(){return!(null!=d.getInfo().active&&void 0!=d.getInfo().active&&0==d.getInfo().active())},d.errorMessage="",d.isValidationDefined=null!=d.getInfo().validationRegex||null!=d.getInfo().validationFct,d.hideIsValidIcon=!!d.getInfo().hideIsValidIcon,d.fieldType=null!=d.getInfo().fieldType?d.getInfo().fieldType:"text",null==d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]=""),null==d.getInfo().isValid&&(d.getInfo().isValid=!d.isValidationDefined),d.isValidationDefined&&d.$watch("getInfo().field[getInfo().fieldName]",function(a,b){return a!==b?d.isValid():void 0}),d.isValid=function(){var a;return d.getInfo().disabled===!0||d.isActive()===!1?void(d.getInfo().isValid=!0):(d.getInfo().field[d.getInfo().fieldName]||(d.getInfo().field[d.getInfo().fieldName]=""),a=!0,"string"!=typeof d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]+=""),null!=d.getInfo().validationRegex&&(a=!!d.getInfo().field[d.getInfo().fieldName]&&null!=d.getInfo().field[d.getInfo().fieldName].match(d.getInfo().validationRegex)),null!=d.getInfo().validationFct&&(a=a&&d.getInfo().validationFct()),void(d.getInfo().isValid=a))},d.isValid(),d.logField=function(){return console.log(d.getInfo())},d.setErrorMessage=function(a){return d.errorMessage=a,null!=d.lastTimeOut&&b.cancel(d.lastTimeOut),d.lastTimeOut=b(function(){return d.errorMessage="",d.lastTimeOut=null},2e3)},d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.openCalculator=function(){c.openCalculatorModal(new function(a){d.getInfo().field[d.getInfo().fieldName]=a})}}}}}}]),myApp.directive("dirFocusMe",function(){return{restrict:"A",scope:{dirFocusMe:"="},link:function(a,b,c){a.$watch("dirFocusMe",function(){return a.dirFocusMe===!0?b[0].focus():void 0})}}}),myApp.directive("numbersOnly",["$filter","translationService","$locale",function(a,b,c){return{restrict:"A",require:"ngModel",link:function(b,d,e,f){return b.$watch(e.numbersOnly,function(){var d,g,h,i,j,k,l;return"integer"!==e.numbersOnly&&"double"!==e.numbersOnly&&"percent"!==e.numbersOnly||(b.lastValidValue=0,"integer"===e.numbersOnly?(i=a("translateText")("--.generic.numberOnly"),k=0):(i=a("translateText")("--.generic.numberOnly"),k=2),b.$root.$on("$localeChangeSuccess",function(a,b,c){var d;return null!=f.$modelValue&&(d=g(parseFloat(f.$modelValue)),null!=d)?(f.$setViewValue(d.toString()),f.$render()):void 0}),f.$parsers.unshift(function(a){var c,g,i;return""===a?null:(c=d(a),isNaN(c)?(h(),b.lastValidValue?(g=b.lastValidValue.toString(),i="percent"===e.numbersOnly?(100*b.lastValidValue).toString():b.lastValidValue.toString()):(g="",i=""),f.$setViewValue(i),f.$render()):("percent"===e.numbersOnly&&(c/=100),b.lastValidValue=c,g=c.toString()),""===g?null:g)}),f.$formatters.unshift(function(a){return b.displayValue(a)}),b.displayValue=function(a){var b;return b=parseFloat(a),"percent"===e.numbersOnly&&(b=100*b),g(b)},h=function(){return null!=b.setErrorMessage?b.setErrorMessage(i):void 0},g=function(a){var b,d;return null==a||isNaN(a)?"":(a=a.toFixed(k),b=c.NUMBER_FORMATS,d=a.toString().replace(new RegExp("\\.","g"),b.DECIMAL_SEP))},d=function(a){var b,d,e;return""===a?NaN:(d=c.NUMBER_FORMATS,b=d.DECIMAL_SEP,"."===b&&(b="\\."),e=a.replace(new RegExp(b,"g"),"."),j(e))},j=function(a){var b;return a.isNaN?NaN:(b="integer"===e.numbersOnly?new RegExp("^(\\-|\\+)?([0-9]+|Infinity)?$"):new RegExp("^(\\-|\\+)?([0-9]+(\\.[0-9]*)?|Infinity)?$"),b.test(a)?Number(a):NaN)},null==f.$modelValue)?void 0:(b.lastValidValue=parseFloat(f.$modelValue),l=b.displayValue(b.lastValidValue),f.$setViewValue(l),f.$render())})}}}]),myApp.directive("dirFieldCheck",["directiveService","$timeout",function(a,b){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldCheck/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(b){return a.autoScopeImpl(b)},post:function(c){a.autoScopeImpl(c),c.errorMessage="",c.hideIsValidIcon=!!c.getInfo().hideIsValidIcon,null==c.getInfo().field[c.getInfo().fieldName]&&(c.getInfo().field[c.getInfo().fieldName]=""),c.isActive=function(){return!(null!=c.getInfo().active&&void 0!=c.getInfo().active&&0==c.getInfo().active())},c.isValid=function(){c.getInfo().isValid=!0},c.isValid(),c.logField=function(){return console.log(c.getInfo())},c.setErrorMessage=function(a){return c.errorMessage=a,null!=c.lastTimeOut&&b.cancel(c.lastTimeOut),c.lastTimeOut=b(function(){return c.errorMessage="",c.lastTimeOut=null},2e3)},c.displayError=function(){return 0==c.getInfo().isValid&&c.getInfo().firstAttempt===!1?!0:!1}}}}}}]),myApp.directive("dirFieldDocument",["directiveService","$upload","$flash","$filter","generateId","$window",function(a,b,c,d,e,f){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldDocument/template.html",replace:!0,transclude:!0,compile:function(){return{post:function(d){a.autoScopeImpl(d),d.id=e.generate(),d.errorMessage="",d.isActive=function(){return!(null!=d.getInfo().active&&void 0!=d.getInfo().active&&0==d.getInfo().active())},d.isValid=function(){d.getInfo().isValid=null!=d.getInfo().optional&&d.getInfo().optional()||0==d.isActive()||null!=d.getInfo().field[d.getInfo().fieldName]},d.isValid(),d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.inDownload=!1,d.percent=0,d.$watch("percent",function(){var a;return d.style={width:d.percent+"%",color:null!=(a=d.percent>50)?a:{white:"black"}}}),d.success=!1,d.onFileSelect=function(a){var e,f;for(d.inDownload=!0,f=0;f<a.length;){e=a[f];var g="/rest/file";null!=d.getInfo().sizex&&void 0!=d.getInfo().sizex&&(g+="/"+d.getInfo().sizex+"/"+d.getInfo().sizey),d.upload=b.upload({url:g,data:{myObj:d.myModelObj},file:e}).progress(function(a){d.percent=parseInt(100*a.loaded/a.total)}).success(function(a,b){d.success=!0,d.percent=100,d.getInfo().field[d.getInfo().fieldName]=a,d.inDownload=!1}).error(function(a,b){d.percent=0,d.inDownload=!1,c.error(a.message)}),f++}},d.fileCall=null,d.$watch("getInfo().field[getInfo().fieldName]",function(a,b){null!=a&&(d.fileCall="/rest/file/"+d.getInfo().field[d.getInfo().fieldName].id),d.isValid()}),d.download=function(){if(null!=d.getInfo().field[d.getInfo().fieldName]){var a="/rest/file/"+d.getInfo().field[d.getInfo().fieldName].id;f.open(a)}}}}}}}]),myApp.directive("dirFieldImageMutiple",["directiveService","$upload","$flash","$filter","generateId","$window",function(a,b,c,d,e,f){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/field/dirFieldImageMutiple/template.html",replace:!0,transclude:!0,compile:function(){return{post:function(d){a.autoScopeImpl(d),d.id=e.generate(),d.errorMessage="",d.isActive=function(){return!(null!=d.getInfo().active&&void 0!=d.getInfo().active&&0==d.getInfo().active())},null==d.getInfo().field[d.getInfo().fieldName]&&(d.getInfo().field[d.getInfo().fieldName]=[]),d.isValid=function(){null!=d.getInfo().optional&&d.getInfo().optional()||0==d.isActive()?d.getInfo().isValid=!0:d.getInfo().isValid=d.getInfo().field[d.getInfo().fieldName].length>0},d.isValid(),d.displayError=function(){return 0==d.getInfo().isValid&&d.getInfo().firstAttempt===!1?!0:!1},d.remove=function(a){for(var b in d.images)d.images[b]==a&&d.images.splice(b,1)},d.success=!1,d.images=[];for(var f in d.getInfo().field[d.getInfo().fieldName])d.images.push({image:d.getInfo().field[d.getInfo().fieldName][f]});d.onFileSelect=function(a){var e,f,g={};for(d.inDownload=!0,f=0;f<a.length;){e=a[f];var h="/rest/file";null!=d.getInfo().sizex&&void 0!=d.getInfo().sizex&&(h+="/"+d.getInfo().sizex+"/"+d.getInfo().sizey),d.images.push(g),d.upload=b.upload({url:h,data:{myObj:d.myModelObj},file:e}).progress(function(a){g.percent=parseInt(100*a.loaded/a.total)}).success(function(a,b){d.success=!0,g.percent=100,g.image=a,d.inDownload=!1}).error(function(a,b){g.percent=0,d.inDownload=!1,c.error(a.message)}),f++}},d.$watch("images",function(){d.getInfo().field[d.getInfo().fieldName]=[];for(var a in d.images)d.getInfo().field[d.getInfo().fieldName].push(d.images[a].image);d.isValid()},!0)}}}}}]),myApp.directive("loginFormCtrl",["$flash","facebookService","translationService","directiveService","$timeout","accountService",function(a,b,c,d,e,f){return{restrict:"E",scope:d.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/login/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return d.autoScopeImpl(a)},post:function(e){d.autoScopeImpl(e),null==e.getInfo().dto&&(e.getInfo().dto={}),e.fields={email:{fieldType:"email",name:"email",fieldTitle:"--.registration.form.yourEmail",validationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validationMessage:"--.generic.validation.email",disabled:function(){return e.getInfo().disabled},field:e.getInfo().dto,fieldName:"email"},password:{name:"password",fieldTitle:"--.generic.yourPassword",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"--.generic.validation.password",fieldType:"password",disabled:function(){return e.getInfo().disabled},field:e.getInfo().dto,fieldName:"password"},keepSessionOpen:{fieldTitle:"--.registration.form.keepSessionOpen",field:!1,disabled:function(){return e.getInfo().disabled},active:function(){return!e.getInfo().mobileVersion},field:e.getInfo().dto,fieldName:"keepSessionOpen"}},e.$watch("fields",function(){var a=!0;for(var b in e.fields){var c=e.fields[b];!e.fields.hasOwnProperty(b)||null!=c.isValid&&c.isValid!==!1||(c.firstAttempt=!e.getInfo().displayErrorMessage,a=!1)}e.getInfo().isValid=a},!0),e.$watch("getInfo().displayErrorMessage",function(){for(var a in e.fields){var b=e.fields[a];b.firstAttempt=!e.getInfo().displayErrorMessage}}),e.fb_login=function(){b.login(function(b){f.setMyself(b),a.success(c.get("--.login.flash.success")),e.getInfo().facebookSuccess(b)},function(b,c){a.error(b.message)})}}}}}}]),myApp.directive("addressFormCtrl",["$flash","directiveService","$timeout","$filter","translationService","modalService",function(a,b,c,d,e,f){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/address/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a);var c=[{key:e.get("--.address.type.home"),value:"--.address.type.home"},{key:e.get("--.address.type.work"),value:"--.address.type.work"},{key:e.get("--.address.type.other"),value:"--.address.type.other"}];if(null==a.getInfo().dto)a.getInfo().dto={name:d("translateText")("--.generic.home")};else{var g=!1;for(var h in c)h==a.getInfo().dto.name&&(g=!0);g||c.push({key:a.getInfo().dto.name,value:a.getInfo().dto.name})}a.fields={name:{fieldTitle:"--.form.address.field.name",options:c,disabled:function(){return a.getInfo().disabled},active:function(){return 1==a.getInfo().addName},field:a.getInfo().dto,fieldName:"name"},street:{fieldType:"text",name:"street",fieldTitle:"--.form.address.field.street",validationRegex:"^.{2,255}$",validationMessage:["--.generic.validation.size","2","255"],disabled:function(){return a.getInfo().disabled},focus:function(){return!a.getInfo().addName},field:a.getInfo().dto,fieldName:"street"},zip:{fieldType:"text",name:"zip",fieldTitle:"--.form.address.field.zip",validationRegex:"^.{2,20}$",validationMessage:["--.generic.validation.size","2","20"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"zip"},city:{fieldType:"text",name:"city",fieldTitle:"--.form.address.field.city",validationRegex:"^.{2,255}$",validationMessage:["--.generic.validation.size","2","255"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"city"}},a.$watch("getInfo().dto",function(){a.getInfo().dto.name==e.get("--.address.type.other")&&f.openOneFieldModal({name:"--.address.customName.fieldTitle"},function(b){c.push({key:b,value:b}),a.getInfo().dto.name=b})},!0),a.$watch("fields",function(){var b=!0;for(var c in a.fields){var d=a.fields[c];a.fields.hasOwnProperty(c)&&(null==d.isValid||d.isValid===!1)&&(d.firstAttempt=!a.getInfo().displayErrorMessage,b=!1)}a.getInfo().isValid=b},!0),a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("customerInterestFormCtrl",["$flash","directiveService","customerInterestService","$timeout",function(a,b,c,d){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/customerInterest/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.interests={},c.getAll(function(b){a.interests=b;for(var c in a.interests)for(var d in a.getInfo().result)a.getInfo().result[d].name==a.interests[c].name&&(a.interests[c].registrationSelection=!0)}),a.select=function(a){a.registrationSelection=!a.registrationSelection},a.$watch("interests",function(b,c){if(b!=c){a.getInfo().isValid=!0,a.getInfo().result=[];for(var d in a.interests){var e=a.interests[d];e.registrationSelection&&a.getInfo().result.push(e)}}},!0)}}}}}]),myApp.directive("accountFormCtrl",["$flash","directiveService",function(a,b){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/account/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.update=null!=a.getInfo().dto,null==a.getInfo().dto&&(a.getInfo().dto={gender:null}),a.passwordActive=!0,a.fields={gender:{name:"gender",fieldTitle:"--.generic.gender",validationRegex:"^.+$",validationMessage:"--.error.validation.not_null",options:[{key:"MALE",value:"--.generic.male"},{key:"FEMALE",value:"--.generic.female"}],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"gender"},firstname:{name:"firstname",fieldTitle:"--.generic.firstname",validationRegex:"^.{2,50}$",validationMessage:["--.generic.validation.size","2","50"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"firstname"},lastname:{name:"lastname",fieldTitle:"--.generic.lastname",validationRegex:"^.{2,50}$",validationMessage:["--.generic.validation.size","2","50"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"lastname"},email:{fieldType:"email",name:"email",fieldTitle:"--.generic.email",validationRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validationMessage:"--.generic.validation.email",disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"email"},password:{name:"password",fieldTitle:"--.registration.form.password",validationRegex:"^[a-zA-Z0-9-_%]{6,18}$",validationMessage:"--.generic.validation.password",fieldType:"password",details:"--.registration.form.password.help",disabled:function(){return a.getInfo().disabled},active:function(){return!a.getInfo().updateMode&&a.passwordActive},field:a.getInfo().dto,fieldName:"password"},repeatPassword:{name:"password",fieldTitle:"--.registration.form.repeatPassword",validationMessage:"--.generic.validation.wrongRepeatPassword",fieldType:"password",disabled:function(){return a.getInfo().disabled},validationFct:function(){return a.fields.password.field===a.fields.repeatPassword.field},active:function(){return!a.getInfo().updateMode&&a.passwordActive},field:a.getInfo().dto,fieldName:"repeatPAssword"},keepSessionOpen:{fieldTitle:"--.registration.form.keepSessionOpen",disabled:function(){return a.getInfo().disabled},active:function(){return!a.getInfo().updateMode&&!a.getInfo().mobileVersion},field:a.getInfo().dto,fieldName:"keepSessionOpen"}},a.getInfo().maskPassword=function(){a.passwordActive=!1},a.$watch("fields",function(){var b=!0;for(var c in a.fields){var d=a.fields[c];!a.fields.hasOwnProperty(c)||null!=d.isValid&&d.isValid!==!1||(d.firstAttempt=!a.getInfo().displayErrorMessage,b=!1)}a.getInfo().isValid=b},!0),a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("businessFormCtrl",["$flash","directiveService",function(a,b){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/business/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),null==a.getInfo().dto&&(a.getInfo().dto={}),a.fields={name:{fieldTitle:"--.generic.name",validationRegex:"^.{2,50}$",validationMessage:["--.generic.validation.size","2","250"],disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"name"},description:{fieldTitle:"--.generic.desc",validationRegex:"^.{0,1500}$",validationMessage:["--.generic.validation.size","0","1500"],disabled:function(){return a.getInfo().disabled},isActive:!a.getInfo().updateMode,field:a.getInfo().dto,fieldName:"description"},phone:{fieldTitle:"--.generic.phone",validationRegex:"^[0-9. *-+]{6,16}$",validationMessage:"--.validation.dto.phone",disabled:function(){return a.getInfo().disabled},isActive:!a.getInfo().updateMode,field:a.getInfo().dto,fieldName:"phone"},email:{fieldTitle:"--.business.contactEmail",name:"email",validationRegex:/^($|(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/,validationMessage:"--.validation.dto.notNull",disabled:function(){return a.getInfo().disabled},isActive:!a.getInfo().updateMode,field:a.getInfo().dto,fieldName:"email"},website:{fieldTitle:"--.business.website",validationRegex:"^($|^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?$)",validationMessage:"--.validation.dto.url",disabled:function(){return a.getInfo().disabled},isActive:!a.getInfo().updateMode,field:a.getInfo().dto,fieldName:"website"}},a.$watch("fields",function(){var b=!0;for(var c in a.fields){var d=a.fields[c];!a.fields.hasOwnProperty(c)||null!=d.isValid&&d.isValid!==!1||(d.firstAttempt=!a.getInfo().displayErrorMessage,b=!1)}a.getInfo().isValid=b},!0),a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("businessCategoryFormCtrl",["$flash","directiveService","businessCategoryService","$timeout",function(a,b,c,d){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/businessCategory/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.isDisabled=function(){return a.getInfo().disabled},a.getInfo().isValid=!1;a.getInfo().value;a.displayValue=function(){if(null!=a.getInfo().value&&a.getInfo().value.length>0)for(var b in a.getInfo().value){var c=a.getInfo().value[b];for(var d in a.categories)for(var e in a.categories[d].children)for(var f in a.categories[d].children[e].children)a.categories[d].children[e].children[f].name==c.name&&(a.subcategories=a.categories[d].children,a.subsubcategories=a.categories[d].children[e].children,a.categories[d].selected=!0,a.categories[d].children[e].selected=!0,a.categories[d].children[e].children[f].selected=!0)}},c.getAll(function(b){a.categories=b.list,a.displayValue()}),a.$watch("getInfo().value",function(){a.displayValue()}),a.select=function(b){1!=b.selected&&(a.cleanSubSubCat(),a.cleanSubCat(),a.cleanCat(),b.selected=!0,a.subcategories=b.children,a.subsubcategories=null,a.compileValue())},a.selectSubcategory=function(b){1!=b.selected&&(a.cleanSubSubCat(),a.cleanSubCat(),a.subsubcategories=b.children,b.selected=!0,a.compileValue())},a.selectSubSubcategory=function(b){b.selected===!0?b.selected=!1:b.selected=!0,a.compileValue()},a.cleanCat=function(){for(var b in a.categories)a.categories[b].selected=!1},a.cleanSubCat=function(){for(var b in a.subcategories)a.subcategories[b].selected=!1},a.cleanSubSubCat=function(){for(var b in a.subsubcategories)a.subsubcategories[b].selected=!1},a.compileValue=function(){if(a.getInfo().isValid=!1,a.getInfo().value.splice(0,a.getInfo().value.length),null!=a.subsubcategories)for(var b in a.subsubcategories)1==a.subsubcategories[b].selected&&(a.getInfo().value.push(a.subsubcategories[b]),a.getInfo().isValid=!0)}}}}}}]),myApp.directive("downloadFormCtrl",["$flash","directiveService","$timeout",function(a,b,c){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/download/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.fields={file:{fieldTitle:"generic.file",disabled:function(){return a.getInfo().disabled},size:a.getInfo().size}},a.$watch("getInfo().dto",function(b,c){a.fields.file.field=a.getInfo().dto}),a.fileCall=null,a.$watch("fields.file.field",function(b,c){null!=b&&(a.fileCall="/rest/file/"+a.fields.file.field.id),a.getInfo().isValid=null!=b,a.getInfo().dto=a.fields.file.field}),a.download=function(){if(null!=a.fields.file.field){var b="/rest/file/"+a.fields.file.field.id;$window.open(b)}},a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("promotionFormCtrl",["$flash","directiveService","$timeout","businessService",function(a,b,c,d){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/promotion/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.update=null!=a.getInfo().dto,a.completePromotion=!0,null==a.getInfo().dto?a.getInfo().dto={startDate:new Date,minimalQuantity:1}:a.completePromotion=null!=a.getInfo().dto.quantity,d.getInterests(function(b){if(a.interests=b,a.interests.length>1){a.fields.interests.isActive=function(){return!0};for(var c in a.interests){var d=a.interests[c];a.fields.interests.options.push({key:d,value:d.translationName})}}}),a.fields={title:{fieldTitle:"--.generic.title",validationRegex:"^.{2,100}$",validationMessage:["--.generic.validation.size","2","100"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"title"},description:{fieldTitle:"--.generic.description",validationRegex:"^.{0,1000}$",validationMessage:["--.generic.validation.size","0","1000"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"description"},startDate:{fieldTitle:"--.promotion.startDate",minimalDelay:"hour",disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"startDate"},endDate:{fieldTitle:"--.promotion.endDate",validationMessage:"--.promotion.validation.endDateBeforeStartDate",minimalDelay:"hour",disabled:function(){return a.getInfo().disabled},validationFct:function(){return a.getInfo().dto.endDate>=a.getInfo().dto.startDate},field:a.getInfo().dto,fieldName:"endDate"},illustration:{fieldTitle:"--.promotion.illustration",validationMessage:"--.error.validation.image",sizex:60,sizey:60,disabled:function(){return a.getInfo().disabled},optional:function(){return!0},field:a.getInfo().dto,multiple:!0,fieldName:"pictures"},quantity:{fieldTitle:"--.promotion.quantity",numbersOnly:"integer",validationRegex:"^[0-9,.]{1,9}$",validationMessage:"--.generic.validation.numberExpected",disabled:function(){return a.getInfo().disabled},active:function(){return a.completePromotion},field:a.getInfo().dto,fieldName:"quantity"},minimalQuantity:{fieldTitle:"--.promotion.minimalQuantity",numbersOnly:"integer",validationRegex:"^[0-9,.]{1,9}$",validationMessage:"--.promotion.validation.minimalQuantityMustBeLowerThanQuantity",disabled:function(){return a.getInfo().disabled},field:1,active:function(){return a.completePromotion},field:a.getInfo().dto,fieldName:"minimalQuantity"},unit:{fieldTitle:"--.promotion.unit",validationRegex:"^.{0,30}$",validationMessage:["--.generic.validation.max","30"],disabled:function(){return a.getInfo().disabled},active:function(){return a.completePromotion},field:a.getInfo().dto,fieldName:"unit"},originalPrice:{fieldTitle:"--.promotion.originalUnitPrice",numbersOnly:"double",validationMessage:"--.generic.validation.numberExpected",validationFct:function(){return null!=a.getInfo().dto.originalPrice},disabled:function(){return a.getInfo().disabled},money:"€",active:function(){return a.completePromotion},field:a.getInfo().dto,fieldName:"originalPrice"},offPercent:{fieldTitle:"--.promotion.offPercent",numbersOnly:"percent",validationFct:function(){return null!=a.getInfo().dto.offPercent&&parseFloat(a.getInfo().dto.offPercent)>0&&parseFloat(a.getInfo().dto.offPercent)<=1},validationMessage:"--.promotion.validation.offPercent",disabled:function(){return a.getInfo().disabled},money:"%",field:a.getInfo().dto,fieldName:"offPercent"},offPrice:{fieldTitle:"--.promotion.offPrice",numbersOnly:"double",validationMessage:"--.promotion.validation.offPrice",validationFct:function(){return null!=a.getInfo().dto.offPrice&&parseFloat(a.getInfo().dto.offPrice)<parseFloat(a.getInfo().dto.originalPrice)},disabled:function(){return a.getInfo().disabled},money:"€",active:function(){
return a.completePromotion},field:a.getInfo().dto,fieldName:"offPrice"},interests:{fieldTitle:"--.promotion.interest",details:"--.promotion.interest.help",validationMessage:"--.error.validation.not_null",options:[],optional:function(){return!1},disabled:function(){return a.getInfo().disabled},isActive:function(){return!1},field:a.getInfo().dto,fieldName:"interest"}};var e=!1;a.$watch("getInfo().dto.originalPrice",function(b,d){b!=d&&null!=a.getInfo().dto.originalPrice&&null!=a.getInfo().dto.offPercent&&0==e&&(e=!0,a.getInfo().dto.offPrice=parseFloat(a.getInfo().dto.originalPrice)*(1-parseFloat(a.getInfo().dto.offPercent)),c(function(){e=!1},1))}),a.$watch("getInfo().dto.offPercent",function(b,d){b!=d&&null!=a.getInfo().dto.originalPrice&&null!=a.getInfo().dto.offPercent&&0==e&&(e=!0,a.getInfo().dto.offPrice=parseFloat(a.getInfo().dto.originalPrice)*(1-parseFloat(a.getInfo().dto.offPercent)),c(function(){e=!1},1))}),a.$watch("getInfo().dto.offPrice",function(b,d){b!=d&&null!=a.getInfo().dto.originalPrice&&a.getInfo().dto.offPrice&&0==e&&(e=!0,a.getInfo().dto.offPercent=1-parseFloat(a.getInfo().dto.offPrice)/parseFloat(a.getInfo().dto.originalPrice),c(function(){e=!1},1))}),null!=a.getInfo().dto.originalPrice&&null!=a.getInfo().dto.offPercent&&0==e&&(e=!0,a.getInfo().dto.offPrice=parseFloat(a.getInfo().dto.originalPrice)*(1-parseFloat(a.getInfo().dto.offPercent)),c(function(){e=!1},1)),a.$watch("fields",function(){var b=!0;for(var c in a.fields){var d=a.fields[c];!a.fields.hasOwnProperty(c)||null!=d.isValid&&d.isValid!==!1||(d.firstAttempt=!a.getInfo().displayErrorMessage,b=!1)}a.getInfo().isValid=b},!0),a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("businessNotificationFormCtrl",["$flash","directiveService","businessService",function(a,b,c){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/businessNotification/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.update=null!=a.getInfo().dto,null==a.getInfo().dto&&(a.getInfo().dto={startDate:new Date}),c.getInterests(function(b){if(a.interests=b,a.interests.length>1){a.fields.interests.isActive=function(){return!0};for(var c in a.interests){var d=a.interests[c];a.fields.interests.options.push({key:d,value:d.translationName})}}}),a.fields={title:{fieldTitle:"--.generic.title",validationRegex:"^.{2,100}$",validationMessage:["--.generic.validation.size","2","100"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"title"},description:{fieldTitle:"--.generic.description",validationRegex:"^.{0,1000}$",validationMessage:["--.generic.validation.size","0","1000"],disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"description"},startDate:{fieldTitle:"--.promotion.startDate",minimalDelay:"hour",disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,fieldName:"startDate"},endDate:{fieldTitle:"--.promotion.endDate",validationMessage:"--.promotion.validation.endDateBeforeStartDate",minimalDelay:"hour",disabled:function(){return a.getInfo().disabled},validationFct:function(){return a.fields.endDate.field>=a.fields.startDate.field},field:a.getInfo().dto,active:function(){return!1},fieldName:"endDate"},illustration:{fieldTitle:"--.promotion.illustration",validationMessage:"--.error.validation.image",sizex:60,sizey:60,optional:function(){return!0},disabled:function(){return a.getInfo().disabled},field:a.getInfo().dto,multiple:!0,fieldName:"pictures"},interests:{fieldTitle:"--.promotion.interest",details:"--.promotion.interest.help",validationMessage:"--.error.validation.not_null",options:[],optional:function(){return!1},disabled:function(){return a.getInfo().disabled},isActive:function(){return!1},field:a.getInfo().dto,fieldName:"interest"}},a.$watch("fields",function(){var b=!0;for(var c in a.fields){var d=a.fields[c];!a.fields.hasOwnProperty(c)||null!=d.isValid&&d.isValid!==!1||(d.firstAttempt=!a.getInfo().displayErrorMessage,b=!1)}a.getInfo().isValid=b},!0),a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("scheduleFormCtrl",["$flash","directiveService",function(a,b){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/schedule/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.days=["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"],a.attendance_selected="LIGHT",a.select_day=null,a.attendance_class={LIGHT:"attendance-light",MODERATE:"attendance-moderate",IMPORTANT:"attendance-heavy"},a.selectAttendance=function(b){a.attendance_selected=b},a.sections=[],a.nbPair=function(a){return!(a%2)},a.hours=[];for(var c=0;49>c;c++){var d="";a.nbPair(c)&&(d=c/2+"h"),a.hours.push({text:d})}for(var e in a.days){var f=a.days[e];a.sections[f]=[];for(var c=0;48>c;c++)a.sections[f].push({minutes:30*c,attendance:"CLOSE"});a.$watch("sections."+f,function(){a.compile()},!0)}a.select=function(b,c){(down||c)&&(b.attendance=a.attendance_selected)},a.compile=function(){for(var b in a.days){var c=a.days[b];(void 0==a.getInfo().dto[c]||null==a.getInfo().dto[c])&&(a.getInfo().dto[c]=[]),a.getInfo().dto[c].splice(0,a.getInfo().dto[c].length);var d=null;for(var e in a.sections[c]){var f=a.sections[c][e];if("CLOSE"!=f.attendance){if(null!=d){if(d.attendance==f.attendance){d.to=f.minutes+30;continue}a.getInfo().dto[c].push(d),d=null}d={attendance:f.attendance,from:f.minutes,to:f.minutes+30}}else null!=d&&(a.getInfo().dto[c].push(d),d=null)}null!=d&&(a.getInfo().dto[c].push(d),d=null)}},a.decompile=function(){for(var b in a.days){var c=a.days[b];for(var d in a.sections[c]){var e=a.sections[c][d];e.attendance="CLOSE"}for(var d in a.getInfo().dto[c]){var e=a.getInfo().dto[c][d];for(var f in a.sections[c]){var g=a.sections[c][f];g.minutes>=e.from&&g.minutes+30<=e.to&&(g.attendance=e.attendance)}}}},a.decompile(),a.startSection=null,a.select=function(b,c){c.attendance=a.attendance_selected,a.startSection=c,a.select_day=b,h()},$(document).mouseup(function(){a.startSection=null,a.select_day=null});var g=function(a,b){var c=a.minutes+30*b,d=c%60;return 10>d&&(d="0"+d),Math.floor(c/60%24)+"h"+d},h=function(){if(null!=a.startSection){for(var b=null,c=null,d=a.startSection.minutes/30;48>=d;d++)if(a.sections[a.select_day][d].attendance!=a.attendance_selected){b=a.sections[a.select_day][d-1];break}for(var d=a.startSection.minutes/30;d>=0;d--)if(a.sections[a.select_day][d].attendance!=a.attendance_selected){c=a.sections[a.select_day][d+1];break}a.selectedTiming=g(c,0)+" to "+g(b,1)}};a.progress=function(b,c,d){if(a.select_day==c&&(a.infoStyle={left:b.pageX+"px",top:b.pageY-75+"px"},null!=a.startSection))if(d.minutes<a.startSection.minutes){for(var e in a.sections[c]){var f=a.sections[c][e];f.minutes>=d.minutes&&f.minutes<=a.startSection.minutes&&(f.attendance=a.attendance_selected)}h()}else{for(var e in a.sections[c]){var f=a.sections[c][e];f.minutes<=d.minutes&&f.minutes>=a.startSection.minutes&&(f.attendance=a.attendance_selected)}h()}}}}}}}]),myApp.directive("imageFormCtrl",["$flash","directiveService",function(a,b){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/image/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),a.imageParam={fieldTitle:"",validationMessage:"--.error.validation.image",sizex:a.getInfo().sizex,sizey:a.getInfo().sizey,field:a.getInfo().dto,fieldName:a.getInfo().fieldName,fullSize:!0}}}}}}]),myApp.directive("businessSocialNetworkCtrl",["$flash","directiveService","languageService",function(a,b,c){return{restrict:"E",scope:b.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/form/businessSocialNetwork/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){return b.autoScopeImpl(a)},post:function(a){b.autoScopeImpl(a),null==a.getInfo().dto&&(a.getInfo().dto={}),a.fields={facebook:{fieldTitle:"--.generic.facebook",fieldImage:"assets/social_network/facebook.png",validationRegex:"^($|https://www.facebook.com/.*$)",validationMessage:"--.generic.validation.facebook",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"facebookLink",placeholder:"https://facebook.com/"},twitter:{fieldTitle:"--.generic.twitter",fieldImage:"assets/social_network/twitter.png",validationRegex:"^($|^https://twitter.com/.*$)",validationMessage:"--.generic.validation.twitter",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"twitterLink",placeholder:"https://twitter.com/"},instagram:{fieldTitle:"--.generic.instagram",fieldImage:"assets/social_network/instagram.png",validationRegex:"^($|^https://instagram.com/.*$)",validationMessage:"--.generic.validation.instagram",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"instagramLink",placeholder:"https://instagram.com/"},delivery:{fieldTitle:"--.business.socialNetwork.delivery",fieldImage:"assets/social_network/delivery.png",validationRegex:"^($|^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?$)",validationMessage:"--.validation.dto.url",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"deliveryLink",placeholder:"http://..."},ecommerce:{fieldTitle:"--.business.socialNetwork.ecommerce",fieldImage:"assets/social_network/e-commerce.png",validationRegex:"^($|^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?$)",validationMessage:"--.validation.dto.url",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"ecommerceLink",placeholder:"http://..."},opinion:{fieldTitle:"--.business.socialNetwork.opinion",fieldImage:"assets/social_network/opinion.png",validationRegex:"^($|^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?$)",validationMessage:"--.validation.dto.url",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"opinionLink",placeholder:"http://..."},reservation:{fieldTitle:"--.business.socialNetwork.reservation",fieldImage:"assets/social_network/reservation.png",validationRegex:"^($|^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?$)",validationMessage:"--.validation.dto.url",disabled:function(){return a.getInfo().disabled},focus:function(){return!0},field:a.getInfo().dto,fieldName:"reservationLink",placeholder:"http://..."}},a.$watch("fields",function(){var b=!0;for(var c in a.fields){var d=a.fields[c];!a.fields.hasOwnProperty(c)||null!=d.isValid&&d.isValid!==!1||(d.firstAttempt=!a.getInfo().displayErrorMessage,b=!1)}a.getInfo().isValid=b},!0),a.$watch("getInfo().displayErrorMessage",function(){for(var b in a.fields){var c=a.fields[b];c.firstAttempt=!a.getInfo().displayErrorMessage}})}}}}}]),myApp.directive("publicationListCtrl",["$rootScope","businessService","geolocationService","directiveService","searchService","$location","accountService","followService","modalService","facebookService",function(a,b,c,d,e,f,g,h,i,j){return{restrict:"E",scope:d.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/component/publicationList/template.html",replace:!0,transclude:!0,compile:function(){return{post:function(a){d.autoScopeImpl(a),a.getInfo().loading=!0,a.navigateTo=function(a){f.path(a)},a.$watch("getInfo().data",function(){a.publications=a.getInfo().data;for(var b in a.publications)a.publications[b].interval=a.publications[b].endDate-new Date}),a.follow=function(b){null!=g.getMyself()?a.followed(b):i.openLoginModal(a.followed,b)},a.followed=function(b){var c=b.following;h.addFollow(!c,b.businessId,function(){b.following=!c,b.following?b.totalFollowers++:b.totalFollowers--;for(var d in a.publications)a.publications[d].businessId==b.businessId&&(a.publications[d].following=b.following,a.publications[d].totalFollowers=b.totalFollowers)})}}}}}}]),myApp.directive("scheduleCtrl",["directiveService",function(a){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/component/schedule/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){},post:function(b){a.autoScopeImpl(b),b.sections=[],b.days=["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"],b.daysTranslation={MONDAY:"day_abrv_monday",TUESDAY:"day_abrv_tuesday",WEDNESDAY:"day_abrv_wednesday",THURSDAY:"day_abrv_thusday",FRIDAY:"day_abrv_friday",SATURDAY:"day_abrv_saturday",SUNDAY:"day_abrv_sunday"},b.attendance_class={LIGHT:"attendance-light",MODERATE:"attendance-moderate",IMPORTANT:"attendance-heavy"},b.nbPair=function(a){return!(a%2)},b.$watch("getInfo().dto",function(){if(null!=b.getInfo().dto&&Object.keys(b.getInfo().dto).length>0){var a=null,c=null;for(var d in b.days){var e=b.days[d];for(var f in b.getInfo().dto[e]){var g=b.getInfo().dto[e][f];(null==a||a>g.from)&&(a=g.from),(null==c||c<g.to)&&(c=g.to)}}a%60==30&&(a-=30),c%60==30&&(c+=30),b.hours=[];for(var h=a/30;c/30>=h;h++){var i="";b.nbPair(h)&&(i=h/2),b.hours.push({text:i})}var j=!0;0==b.getInfo().dto.SATURDAY.length&&0==b.getInfo().dto.SUNDAY.length&&(j=!1);for(var d in b.days){var e=b.days[d];if("SUNDAY"!=e&&"SATURDAY"!=e||0!=j){b.sections[e]=[];for(var h=a/30;c/30>h;h++)b.sections[e].push({minutes:30*h,attendance:"CLOSE"})}}for(var d in b.days){var e=b.days[d];for(var f in b.sections[e]){var g=b.sections[e][f];g.attendance="CLOSE"}for(var f in b.getInfo().dto[e]){var g=b.getInfo().dto[e][f];for(var k in b.sections[e]){var l=b.sections[e][k];l.minutes>=g.from&&l.minutes+30<=g.to&&(l.attendance=g.attendance)}}}}},!0)}}}}}]),myApp.directive("galleryCtrl",["$rootScope","businessService","geolocationService","directiveService","searchService","$location","accountService","followService","modalService",function(a,b,c,d,e,f,g,h,i){return{restrict:"E",scope:d.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/component/gallery/template.html",replace:!0,transclude:!0,compile:function(){return{post:function(a){d.autoScopeImpl(a),a.openGallery=function(b){i.galleryModal(b,a.getInfo().images)}}}}}}]),myApp.directive("googleMapWidgetCtrl",["$rootScope","businessService","geolocationService","directiveService","$window",function(a,b,c,d,e){return{restrict:"E",scope:d.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/component/googleMapWidget/template.html",replace:!0,transclude:!0,compile:function(){return{post:function(a){d.autoScopeImpl(a),a.$watch("getInfo().address",function(){a.getInfo().refreshNow=function(){a.centerMap()},null!=a.getInfo().address&&(a.centerMap=function(){a.map={center:{latitude:a.getInfo().address.posx,longitude:a.getInfo().address.posy}}},a.toGoogleMap=function(){function b(){if(/iP(hone|od|ad)/.test(navigator.platform)){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}}if(-1!==navigator.platform.indexOf("iPhone")||-1!==navigator.platform.indexOf("iPod")){var c=b()||[0],d="";d=c[0]>=6?"maps://":"http://",window.location=d+a.complete("maps.apple.com/maps")}else window.open(a.complete("http://maps.google.com"))},a.complete=function(b){var c=a.getInfo().address;return b+="?q="+c.posx+",+"+c.posy})})}}}}}]),myApp.directive("searchResultCtrl",["directiveService","$location","searchBarService",function(a,b,c){return{restrict:"E",scope:a.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/component/searchResult/template.html",replace:!0,transclude:!0,compile:function(){return{pre:function(a){},post:function(d){a.autoScopeImpl(d);var e=-1;d.$watch("getInfo().result",function(){if(null!=d.getInfo().result){e=-1;for(var a in d.getInfo().result.businesses)d.getInfo().result.businesses[a].index=++e;d.seeMoreBusinessIndex=++e;for(var a in d.getInfo().result.publications)d.getInfo().result.publications[a].index=++e;d.seeMorePublicationIndex=++e;for(var a in d.getInfo().result.categories)d.getInfo().result.categories[a].index=++e;d.seeMoreCategoryIndex=++e,d.seeMoreIndex=++e}else d.getInfo().display=!1;d.indexSelected=null}),d.indexSelected=null,$(document).keydown(function(a){if(40==a.keyCode)null==d.indexSelected||d.indexSelected==e?d.indexSelected=0:d.indexSelected++,d.$apply();else if(38==a.keyCode)null==d.indexSelected||0==d.indexSelected?d.indexSelected=e:d.indexSelected--,d.$apply();else if(13==a.keyCode){for(var b in d.getInfo().result.businesses)if(d.indexSelected==d.getInfo().result.businesses[b].index){d.goToBusiness(d.getInfo().result.businesses[b]);break}for(var b in d.getInfo().result.categories)if(d.indexSelected==d.getInfo().result.categories[b].index){d.goToCategory(d.getInfo().result.categories[b]);break}for(var b in d.getInfo().result.publications)if(d.indexSelected==d.getInfo().result.publications[b].index){d.goToPublication(d.getInfo().result.publications[b]);break}d.$apply()}else 27==a.keyCode&&(d.getInfo().display=!1,d.indexSelected=null,d.$apply())}),$(document).click(function(){$("#searchContainer").is(":hover")||(d.getInfo().display=!1,d.indexSelected=null,d.$apply())}),d.select=function(a){d.indexSelected=a},d.seeAll=function(){d.navigateTo("search/"+c.currentSearch)},d.goToPublication=function(a){d.navigateTo("business/"+a.businessId+"/publication/"+a.id)},d.goToBusiness=function(a){d.navigateTo("business/"+a.id)},d.seeAllPublication=function(){d.navigateTo("search/publication:"+f(c.currentSearch))},d.seeAllBusiness=function(){d.navigateTo("search/business:"+f(c.currentSearch))},d.seeAllCategory=function(){d.navigateTo("search/category:"+f(c.currentSearch))},d.goToCategory=function(a){var b=null;b=null!=a.subSubCategory?a.subSubCategory.translationName:null!=a.subCategory?a.subCategory.translationName:a.category.translationName,d.navigateTo("search/category:"+f(b))};var f=function(a){return-1!=a.indexOf(":")?a.split(":")[1]:a};d.navigateTo=function(a){b.path(a),d.getInfo().display=!1,d.getInfo().cleanSearch()}}}}}}]),myApp.directive("searchBarCtrl",["$rootScope","businessService","geolocationService","directiveService","searchService","searchService","searchBarService","$timeout",function(a,b,c,d,e,e,f,g){return{restrict:"E",scope:d.autoScope({ngInfo:"="}),templateUrl:"/assets/javascripts/directive/component/searchBar/template.html",replace:!0,transclude:!0,compile:function(){return{post:function(b){d.autoScopeImpl(b),b.advancedSearch=!1,b.displayAdvancedSearch=function(){b.advancedSearch=!b.advancedSearch,a.$broadcast("DISPLAY_ADVANCED_SEARCH",{display:b.advancedSearch})},b.searchBarService=f,b.searchResultParam={display:!1,cleanSearch:function(){f.currentSearch=""}},b.$watch("searchBarService.currentSearch",function(a,c){if(f.displaySearchResult&&a!=c&&""!=f.currentSearch&&f.currentSearch.length>=2){var d=angular.copy(f.currentSearch);g(function(){d==f.currentSearch&&(-1!=f.currentSearch.indexOf(":")&&f.currentSearch.split(":")[1].length>0||-1==f.currentSearch.indexOf(":")&&f.currentSearch.length>0)&&e.searchByStringLittle(f.currentSearch,function(a){b.searchResultParam.result=a,b.searchResultParam.display=!0})},500)}}),b.search=function(){}}}}}}]),myApp.filter("translateText",["$sce","translationService",function(a,b){return function(a,c){var d;if("object"==typeof a){d=b.get(a[0]);for(var e in a)0!=e&&(d=d.replace("{"+(parseFloat(e)-1)+"}",a[e]));return d}if(d=b.get(a),null!=c)if("array"==typeof c)for(var e in c)d=d.replace("{"+e+"}",c[e]);else d=d.replace("{0}",c);return d}}]),myApp.filter("zeropad",["$sce","translationService",function(a,b){return function(a){var b=2,c=parseInt(a,10);if(b=parseInt(b,10),isNaN(c)||isNaN(b))return a;for(c=""+c;c.length<b;)c="0"+c;return c}}]),myApp.filter("image",function(){return function(a){return null!=a&&void 0!=a?"https://s3.amazonaws.com/lynk-test/"+a.storedName:null}}),initializeCommonRoutes(),myApp.controller("MainCtrl",["$scope","$locale","translationService","$window","facebookService","languageService","$location","modalService","accountService","geolocationService",function(a,b,c,d,e,f,g,h,i,j){a.navigateTo=function(a){g.path(a)},"data"in window&&void 0!=data&&null!=data&&c.set(data.translations),i.setMyself(data.mySelf),e.facebookAppId=data.appId,f.setLanguages(lang,languages),e.ini(),null==i.getMyself()?e.getLoginStatus():e.recover(),a.helpDisplayed=!1,a.displayHelp=function(){a.helpDisplayed=!0},a.maskHelp=function(){a.helpDisplayed=!1},a.openHelp=function(a){h.openHelpModal(a)}}]),myApp.service("directiveService",["$sce",function(a){this.autoScope=function(a){var b,c,d;c={};for(b in a)d=a[b],c[b]=d,"ng"===b.slice(0,2)&&"="===d&&(c[b[2].toLowerCase()+b.slice(3)]="@");return c},this.autoScopeImpl=function(b,c){var d,e,f;b.$$NAME=c;for(e in b)f=b[e],"ng"===e.slice(0,2)&&(d=function(a,b){return function(){var c;return c=0,c=void 0===a[b]||null===a[b]||""===a[b]?a[b[2].toLowerCase()+b.slice(3)]:a[b],a["decorate"+b.slice(2)]?a["decorate"+b.slice(2)](c):c}},b["get"+e.slice(2)]=d(b,e));return b.isTrue=function(a){return a===!0||"true"===a||"y"===a},b.isFalse=function(a){return a===!1||"false"===a||"n"===a},b.isNull=function(a){return null===a},b.html=function(b){return a.trustAsHtml(b)}}}]),myApp.service("$flash",["$filter",function(a){Messenger.options={extraClasses:"messenger-fixed messenger-on-top messenger-on-center cr-messenger",theme:"block"},this.success=function(a){print(a,"success")},this.info=function(a){print(a,"info")},this.error=function(a){print(a,"error")},this.warning=function(a){print(a,"warning")},print=function(a,b){if(!angular.isUndefined(a)&&null!==a)for(var c in a.split("\n")){var d=a.split("\n")[c];Messenger().post({message:d,type:b,showCloseButton:!0})}}}]),myApp.service("translationService",["$rootScope","$filter","$http","$locale",function(a,b,c,d){var e;e=this,e.elements=null,e.set=function(a){e.elements=a.translations},e.get=function(a){return e.elements[a]?e.elements[a]:a},e.translateExceptionsDTO=function(a){return null!=a.params&&Object.keys(a.params).length>0?b("translateTextWithVars")(a.messageToTranslate,a.params):null!=a.messageToTranslate?b("translate")(a.messageToTranslate):a.message}}]),myApp.service("modelService",["$rootScope",function(a){this.MY_SELF="MYSELF",this.APP_ID="APP_ID",this.model={},this.set=function(a,b){this.model[a]=b},this.get=function(a){return this.model[a]},this.remove=function(a){delete this.model[a]}}]),myApp.service("facebookService",["$http","accountService","$locale","languageService","$FB",function(a,b,c,d,e){this.facebookAppId,this.ini=function(){FB.init({appId:this.facebookAppId,cookie:!0,xfbml:!0,version:"v2.3"}),e.init(this.facebookAppId),FB.getLoginStatus(function(a){"connected"==a.status&&(f=!0)})};var f=!1;this.isConnected=function(){return f},this.registration=function(a,b){FB.login(function(c){"connected"===c.status?(a(c.authResponse),f=!0):b()},{scope:"public_profile, email,publish_actions"})},this.login=function(a,b){FB.login(function(c){"connected"===c.status?(loginToServer(c.authResponse,a,b),f=!0):b()},{scope:"public_profile, email,publish_actions"})},this.recover=function(a,b){FB.getLoginStatus(function(a){})},me=function(a,b){FB.api("/me",{fields:"first_name,last_name,email,gender,locale"},function(c){!c||c.error?b(c.status,c.error):a(c)})},this.getLoginStatus=function(){FB.getLoginStatus(function(a){"connected"===a.status&&(f=!0,loginToServer(a.authResponse,function(a){b.setMyself(a),d.changeLanguage(a.lang.code)},function(){}))})},this.logout=function(){FB.logout(function(a){})},this.share=function(a){a=a.replace("#","%23"),FB.ui({method:"share_open_graph",action_type:"og.likes",action_properties:JSON.stringify({object:a})},function(a){})},loginToServer=function(b,c,d){var e=b.accessToken,f=b.userID,g={userId:f,token:e};a({method:"POST",url:"/rest/login/facebook",headers:"Content-Type:application/json;charset=utf-8",data:g}).success(function(a){null!=c&&c(a)}).error(function(a,b){null!=d&&d(a,b)})}}]),myApp.service("languageService",["$flash","$window","$http","$rootScope",function(a,b,c,d){this.languages,this.languagesStructured=[],this.currentLanguage;var e=this;this.setLanguages=function(a,b){this.currentLanguage=a,this.languages=b;for(var c in b)lang=b[c],this.languagesStructured.push({key:lang.code,value:lang.language})},d.$watch(function(){return e.currentLanguage},function(a,b){a!=b&&e.changeLanguage(e.currentLanguage,!0)}),this.changeLanguage=function(d,e){(d!=this.currentLanguage||e)&&c({method:"PUT",url:"/rest/language/"+d,headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,c){b.location.reload()}).error(function(b,c){a.error(b.message)})}}]),myApp.service("customerInterestService",["$sce","$http","$flash",function(a,b,c){var d=null,e=function(a,e){b({method:"GET",url:"/rest/customerInterest",headers:"Content-Type:application/json;charset=utf-8"}).success(function(b,c){d=b.list,null!=a&&a(b.list)}).error(function(a,b){null!=e&&e(a,b),c.error(a)})};this.getAll=function(a){null==d?e(a):a(angular.copy(d))}}]),myApp.service("accountService",["$flash","$http",function(a,b){var c=this;this.model={myself:null},this.testEmail=function(c,d,e){b({method:"GET",url:"/rest/email/test/"+c,headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){null!=d&&d(a.value)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.registration=function(d,e,f){b({method:"POST",url:"/rest/registration/customer",headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.setMyself(a),null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.testFacebook=function(c,d,e){b({method:"POST",url:"/rest/facebook/test",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.logout=function(d,e){b({method:"GET",url:"/rest/logout",headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){c.setMyself(null),null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.accountFusion=function(d,e,f){b({method:"POST",url:"/rest/account/fusion",headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(b,d){a.success(translationService.get("--.login.flash.success")),c.setMyself(b),null!=e&&e(b)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.changePassword=function(d,e,f,g){var h={oldPassword:d,newPassword:e};b({method:"PUT",url:"/rest/account/password/"+c.getMyself().id,headers:"Content-Type:application/json;charset=utf-8",data:h}).success(function(a,b){null!=f&&f(a)}).error(function(b,c){a.error(b.message),null!=g&&g(b,c)})},this.editAccount=function(d,e,f){b({method:"PUT",url:"/rest/account/"+c.getMyself().id,headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.setMyself(a),null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.login=function(d,e,f){b({method:"POST",url:"/rest/login",headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.setMyself(a),null!=e&&e(a)}).error(function(b,c){console.log(b),a.error(b.message),null!=f&&f(b,c)})},this.addAddress=function(d,e,f){b({method:"POST",url:"/rest/address",headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.getMyself().addresses.push(a),null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.editAddress=function(d,e,f){b({method:"PUT",url:"/rest/address/"+d.id,headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){for(var f in c.getMyself().addresses)c.getMyself().addresses[f].id==d.id&&c.getMyself().addresses.splice(f,1,a);null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.deleteAddress=function(d,e,f){b({method:"DELETE",url:"/rest/address/"+d.id,headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){for(var f in c.getMyself().addresses)c.getMyself().addresses[f].id==d.id&&c.getMyself().addresses.splice(f,1);null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.editCustomerInterest=function(d,e,f){b({method:"PUT",url:"/rest/customer/interest/"+c.getMyself().id,headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.getMyself().customerInterests=a.list,null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.forgotPassword=function(c,d,e){b({method:"PUT",url:"/rest/forgot/password",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.getMyself=function(){return this.model.myself},this.setMyself=function(a){this.model.myself=a}}]),myApp.service("businessCategoryService",["$sce","$http","$flash",function(a,b,c){var d=null,e=function(a,e){b({method:"GET",url:"/rest/businessCategory",headers:"Content-Type:application/json;charset=utf-8"}).success(function(b,c){d=b,null!=a&&a(b)}).error(function(a,b){null!=e&&e(a,b),c.error(a.message)})};this.getAll=function(a){null==d?e(a):a(angular.copy(d))}}]),myApp.service("businessService",["$flash","$http","accountService",function(a,b,c){this.getBusiness=function(c,d,e){b({method:"GET",url:"/rest/business/"+c,headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.registration=function(d,e,f){b({method:"POST",url:"/rest/registration/business",headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.setMyself(a),null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.edit=function(d,e,f){b({method:"PUT",url:"/rest/business",headers:"Content-Type:application/json;charset=utf-8",data:d}).success(function(a,b){c.getMyself().business=a,null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.editSocialNetwork=function(c,d,e){b({method:"PUT",url:"/rest/business/social_network",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.editBusinessCategory=function(c,d,e){b({method:"PUT",url:"/rest/business/category",headers:"Content-Type:application/json;charset=utf-8",data:{list:c}}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.publishBusiness=function(c,d){b({method:"POST",url:"/rest/business/ask_publication",headers:"Content-Type:application/json;charset=utf-8",data:{}}).success(function(a,b){null!=c&&c(a)}).error(function(b,c){a.error(b.message),null!=d&&d(b,c)})},this.cancelPublishRequest=function(c,d){b({method:"POST",url:"/rest/business/cancel_publication_request",headers:"Content-Type:application/json;charset=utf-8",data:{}}).success(function(a,b){null!=c&&c(a)}).error(function(b,c){a.error(b.message),null!=d&&d(b,c)})},this.stopPublication=function(c,d){b({method:"POST",url:"/rest/business/stop_publish",headers:"Content-Type:application/json;charset=utf-8",data:{}}).success(function(a,b){null!=c&&c(a)}).error(function(b,c){a.error(b.message),null!=d&&d(b,c)})},this.editIllustration=function(c,d,e){b({method:"PUT",url:"/rest/business/illustration",headers:"Content-Type:application/json;charset=utf-8",
data:c}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.editLandscape=function(c,d,e){b({method:"PUT",url:"/rest/business/landscape",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.editAddress=function(c,d,e){b({method:"PUT",url:"/rest/business/address",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.createSchedule=function(c,d,e){b({method:"POST",url:"/rest/business/schedule",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a.list)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.editGallery=function(c,d,e){b({method:"POST",url:"/rest/business/edit/gallery",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a.list)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.getInterests=function(c,d){b({method:"GET",url:"/rest/business/interests",headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){null!=c&&c(a.list)}).error(function(b,c){a.error(b.message),null!=d&&d(b,c)})}}]),myApp.service("modalService",["$modal",function(a){this.basicModal=function(b,c,d,e){var f={directiveName:function(){return c},param:function(){return d},title:function(){return b},save:function(){return e}};a.open({templateUrl:"/assets/javascripts/modal/BasicModal/view.html",controller:"BasicModalCtrl",size:"lg",resolve:f})},this.messageModal=function(b,c,d){var e={message:function(){return c},title:function(){return b},save:function(){return d}};a.open({templateUrl:"/assets/javascripts/modal/MessageModal/view.html",controller:"MessageModalCtrl",size:"lg",resolve:e})},this.openCustomerRegistrationModal=function(b,c){var d={fctToExecute:function(){return b},fctToExecuteParams:function(){return c}};a.open({templateUrl:"/assets/javascripts/modal/CustomerRegistrationModal/view.html",controller:"CustomerRegistrationModalCtrl",size:"lg",resolve:d})},this.openBusinessRegistrationModal=function(){a.open({templateUrl:"/assets/javascripts/modal/BusinessRegistrationModal/view.html",controller:"BusinessRegistrationModalCtrl",size:"lg"})},this.openEditProfileModal=function(){a.open({templateUrl:"/assets/javascripts/modal/EditProfileModal/view.html",controller:"EditProfileModalCtrl",size:"l"})},this.openLoginModal=function(b,c){var d={fctToExecute:function(){return b},fctToExecuteParams:function(){return c}};a.open({templateUrl:"/assets/javascripts/modal/LoginModal/view.html",controller:"LoginModalCtrl",size:"l",resolve:d})},this.openHelpModal=function(b){var c={message:function(){return b}};a.open({templateUrl:"/assets/javascripts/modal/HelpModal/view.html",controller:"HelpModalCtrl",size:"sm",resolve:c})},this.openCalculatorModal=function(b){var c={setResult:function(){return function(a){b(a)}}};a.open({templateUrl:"/assets/javascripts/modal/Calculator/view.html",controller:"CalculatorModalCtrl",size:"sm",resolve:c})},this.openFacebookFusionModal=function(b){var c={accountFusion:function(){return b}};a.open({templateUrl:"/assets/javascripts/modal/AccountFusionFacebookModal/view.html",controller:"AccountFusionFacebookModalCtrl",size:"l",resolve:c})},this.openEditPasswordModal=function(){a.open({templateUrl:"/assets/javascripts/modal/ChangePassword/view.html",controller:"ChangePasswordModalCtrl",size:"l"})},this.openEditCustomerInterest=function(){a.open({templateUrl:"/assets/javascripts/modal/EditCustomerInterestModal/view.html",controller:"EditCustomerInterestModalCtrl",size:"lg"})},this.addressModal=function(b,c,d){var e={dto:function(){return c},addName:function(){return b},isBusiness:function(){return d}};a.open({templateUrl:"/assets/javascripts/modal/AddressModal/view.html",controller:"AddressModalCtrl",size:"l",resolve:e})},this.openForgotPasswordModal=function(b){var c={email:function(){return b}};a.open({templateUrl:"/assets/javascripts/modal/ForgotPasswordModal/view.html",controller:"ForgotPasswordModalCtrl",size:"l",resolve:c})},this.openPromotionModal=function(b,c){var d={dto:function(){return b},callback:function(){return c}};a.open({templateUrl:"/assets/javascripts/modal/PromotionModal/view.html",controller:"PromotionModalCtrl",size:"l",resolve:d})},this.openBusinessNotificationModal=function(b,c){var d={dto:function(){return b},callback:function(){return c}};a.open({templateUrl:"/assets/javascripts/modal/BusinessNotificationModal/view.html",controller:"BusinessNotificationModalCtrl",size:"l",resolve:d})},this.openOneFieldModal=function(b,c){var d={field:function(){return b},callback:function(){return c}};a.open({templateUrl:"/assets/javascripts/modal/OneFieldModal/view.html",controller:"OneFieldModalCtrl",size:"l",resolve:d})},this.galleryModal=function(b,c){var d={image:function(){return b},images:function(){return c}};a.open({templateUrl:"/assets/javascripts/modal/GalleryModal/view.html",controller:"GalleryModalCtrl",windowClass:"modal-gallery-content",size:"lg",resolve:d})}}]),myApp.service("promotionService",["$http","$flash","$rootScope",function(a,b,c){this.add=function(c,d,e){a({method:"POST",url:"/rest/promotion",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(a,c){b.error(a.message),null!=e&&e(a,c)})},this.edit=function(c,d,e){a({method:"PUT",url:"/rest/promotion/"+c.id,headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a)}).error(function(a,c){b.error(a.message),null!=e&&e(a,c)})}}]),myApp.service("geolocationService",["geolocation","$http","accountService","$timeout","$rootScope","$window",function(a,b,c,d,e,f){this.position=null,this.currentPosition=null;var g=this;b({method:"GET",url:"http://ipinfo.io/json",headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){if(null==g.currentPosition){var c=a.loc.split(",");g.currentPosition={x:c[0],y:c[1]},h(),d(function(){e.$broadcast("POSITION_CHANGED")},1)}}),f.navigator&&f.navigator.geolocation&&f.navigator.geolocation.getCurrentPosition(function(a){g.currentPosition={x:a.coords.latitude,y:a.coords.longitude},h(),d(function(){e.$broadcast("POSITION_CHANGED")},1)});var h=function(){null==c.getMyself()||null==c.getMyself().selectedAddress?null==g.currentPosition?e.$watch(function(){return g.currentPosition},function(a,b){null!=a&&(g.position={x:g.currentPosition.x,y:g.currentPosition.y})}):g.position={x:g.currentPosition.x,y:g.currentPosition.y}:g.position={x:c.getMyself().selectedAddress.posx,y:c.getMyself().selectedAddress.posy}};d(function(){h()},1),e.$watch(function(){return null!=c.model.myself?c.model.myself.selectedAddress:null},function(a,b){h()}),this.getLocationText=function(){return null==c.getMyself()||null==c.getMyself().selectedAddress?"currentPosition":c.getMyself().selectedAddress.name}}]),myApp.service("businessNotificationService",["$http","$flash","$rootScope",function(a,b,c){this.REFRESH_BUSINESS_NOTIFICAITON="REFRESH_BUSINESS_NOTIFICAITON";var d=this;this.add=function(e,f,g){a({method:"POST",url:"/rest/businessNotification",headers:"Content-Type:application/json;charset=utf-8",data:e}).success(function(a,b){null!=f&&f(a),c.$broadcast(d.REFRESH_BUSINESS_NOTIFICAITON)}).error(function(a,c){b.error(a.message),null!=g&&g(a,c)})},this.edit=function(e,f,g){a({method:"PUT",url:"/rest/businessNotification/"+e.id,headers:"Content-Type:application/json;charset=utf-8",data:e}).success(function(a,b){null!=f&&f(a),c.$broadcast(d.REFRESH_BUSINESS_NOTIFICAITON)}).error(function(a,c){b.error(a.message),null!=g&&g(a,c)})}}]),myApp.service("addressService",["$flash","$http","geolocationService",function(a,b,c){this.testAddress=function(c,d,e){b({method:"POST",url:"/rest/address/test",headers:"Content-Type:application/json;charset=utf-8",data:c}).success(function(a,b){null!=d&&d(a.value)}).error(function(b,c){a.error(b.message),null!=e&&e(b,c)})},this.distance=function(d,e,f){null!=c.position&&b({method:"POST",url:"/rest/address/distance/"+d,headers:"Content-Type:application/json;charset=utf-8",data:c.position}).success(function(a,b){null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.changeAddress=function(d,e,f){null!=c.position&&b({method:"PUT",url:"/rest/address/current",headers:"Content-Type:application/json;charset=utf-8",data:{addressName:d}}).success(function(a,b){null!=e&&e(a)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})}}]),myApp.service("followService",["$flash","$http",function(a,b){this.model={myself:null},this.addFollow=function(c,d,e,f){var g={follow:c,businessId:d};b({method:"POST",url:"/rest/follow",headers:"Content-Type:application/json;charset=utf-8",data:g}).success(function(a,b){null!=e&&e(a.value)}).error(function(b,c){a.error(b.message),null!=f&&f(b,c)})},this.getFollows=function(c,d){b({method:"GET",url:"/rest/follow",headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){null!=c&&c(a.list)}).error(function(b,c){a.error(b.message),null!=d&&d(b,c)})}}]),myApp.service("searchService",["$http","$flash","$rootScope","geolocationService","$q",function(a,b,c,d,e){this.currentSearch="";var f=null;this["default"]=function(c,g){null!=f&&f.resolve(),f=e.defer(),a({method:"POST",url:"/rest/search/publication/default",headers:"Content-Type:application/json;charset=utf-8",data:d.position,config:{timeout:f.promise}}).success(function(a,b){null!=c&&c(a.list)}).error(function(a,c){b.error(a.message),null!=g&&g(a,c)})},this.searchByStringLittle=function(c,g,h){null!=f&&f.resolve(),f=e.defer(),a({method:"POST",url:"/rest/search/text/little",headers:"Content-Type:application/json;charset=utf-8",data:{search:c,position:d.position},config:{timeout:f.promise}}).success(function(a,b){null!=g&&g(a)}).error(function(a,c){b.error(a.message),null!=h&&h(a,c)})},this.searchByString=function(c,g,h){null!=f&&f.resolve(),f=e.defer(),a({method:"POST",url:"/rest/search/text",headers:"Content-Type:application/json;charset=utf-8",data:{search:c,position:d.position},config:{timeout:f.promise}}).success(function(a,b){null!=g&&g(a)}).error(function(a,c){b.error(a.message),null!=h&&h(a,c)})},this.byFollowed=function(c,g){null!=f&&f.resolve(),f=e.defer(),a({method:"POST",url:"/rest/search/publication/followed",headers:"Content-Type:application/json;charset=utf-8",data:d.position,config:{timeout:f.promise}}).success(function(a,b){null!=c&&c(a.list)}).error(function(a,c){b.error(a.message),null!=g&&g(a,c)})},this.byFollowedAndInterest=function(c,g,h){null!=f&&f.resolve(),f=e.defer(),a({method:"POST",url:"/rest/search/publication/followed/interest/"+c,headers:"Content-Type:application/json;charset=utf-8",data:d.position,config:{timeout:f.promise}}).success(function(a,b){null!=g&&g(a.list)}).error(function(a,c){b.error(a.message),null!=h&&h(a,c)})},this.byBusiness=function(c,g,h){null!=f&&f.resolve(),f=e.defer(),console.log("geolocationService.position"),console.log(d.position),a({method:"POST",url:"/rest/search/publication/business/"+c,headers:"Content-Type:application/json;charset=utf-8",data:d.position,config:{timeout:f.promise}}).success(function(a,b){null!=g&&g(a.list)}).error(function(a,c){b.error(a.message),null!=h&&h(a,c)})},this.byInterest=function(c,g,h){null!=f&&f.resolve(),f=e.defer(),a({method:"POST",url:"/rest/search/publication/interest/"+c,headers:"Content-Type:application/json;charset=utf-8",data:d.position,config:{timeout:f.promise}}).success(function(a,b){null!=g&&g(a.list)}).error(function(a,c){b.error(a.message),null!=h&&h(a,c)})}}]),myApp.service("searchBarService",["$timeout","$rootScope",function(a,b){this.currentSearch="",this.searchCriteria=data.searchCriterias;var c=this,d=!1;this.displaySearchResult=!0,this.setCurrentSearch=function(b){c.displaySearchResult=!1,this.currentSearch=b,a(function(){c.displaySearchResult=!0},1)},b.$watch(function(){return c.searchCriteria},function(b,e){if(!d){d=!0,c.currentSearch="";var f=!0;for(var g in c.searchCriteria)c.searchCriteria[g].selected===!0&&(f?f=!1:c.currentSearch+="|",c.currentSearch+=c.searchCriteria[g].key);f||(c.currentSearch+=":",$(".search-bar").focus()),a(function(){d=!1},1)}},!0),b.$watch(function(){return c.currentSearch},function(b,e){if(!d){d=!0;for(var f in c.searchCriteria)c.searchCriteria[f].selected=!1;if(-1!=c.currentSearch.indexOf(":")){var g=c.currentSearch.split(":")[0].split("|");for(var f in c.searchCriteria){var h=!1;for(var i in g)g[i]==c.searchCriteria[f].key&&(c.searchCriteria[f].selected=!0,h=!0)}}a(function(){d=!1},1)}})}]),myApp.service("publicationService",["$http","$flash","$rootScope",function(a,b,c){this["delete"]=function(c,d,e){a({method:"DELETE",url:"/rest/publication/"+c.id,headers:"Content-Type:application/json;charset=utf-8"}).success(function(a,b){null!=d&&d(a)}).error(function(a,c){b.error(a.message),null!=e&&e(a,c)})}}]);